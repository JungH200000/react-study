## ê°œë°œìë¥¼ ê´´ë¡­íˆëŠ” CORS ì˜¤ë¥˜, í”„ë¡ì‹œ(Proxy)ë¡œ í•´ê²°í•˜ê¸°

React ê°œë°œ ì¤‘ `fetch`ë¡œ ì™¸ë¶€ APIì— ë°ì´í„°ë¥¼ ìš”ì²­í–ˆì„ ë•Œ, ì½˜ì†”ì— ë‚˜íƒ€ë‚˜ëŠ” ë¹¨ê°„ CORS ì˜¤ë¥˜ ë©”ì‹œì§€ëŠ” ë§ì€ ê°œë°œìë¥¼ ë‹¹í™©í•˜ê²Œ ë§Œë“­ë‹ˆë‹¤. ì´ ê¸€ì—ì„œëŠ” CORS ì˜¤ë¥˜ê°€ ì™œ ë°œìƒí•˜ëŠ”ì§€, ê·¸ë¦¬ê³  Vite í™˜ê²½ì—ì„œ **í”„ë¡ì‹œ(Proxy)** ë¥¼ ì´ìš©í•´ ì´ ë¬¸ì œë¥¼ ì–´ë–»ê²Œ í•´ê²°í•˜ëŠ”ì§€ ì•Œì•„ë³´ê² ìŠµë‹ˆë‹¤.

### CORS ì˜¤ë¥˜, ë„ëŒ€ì²´ ì™œ ë°œìƒí• ê¹Œ? ğŸ›¡ï¸

CORS(Cross-Origin Resource Sharing, êµì°¨ ì¶œì²˜ ë¦¬ì†ŒìŠ¤ ê³µìœ ) ì˜¤ë¥˜ëŠ” ì›¹ ë¸Œë¼ìš°ì €ì˜ **'ë™ì¼ ì¶œì²˜ ì •ì±…(Same-Origin Policy)'** ë•Œë¬¸ì— ë°œìƒí•©ë‹ˆë‹¤. ì´ëŠ” ë³´ì•ˆìƒì˜ ì´ìœ ë¡œ, ë‹¤ë¥¸ 'ì¶œì²˜(Origin)'ë¥¼ ê°€ì§„ ë¦¬ì†ŒìŠ¤ë¥¼ í•¨ë¶€ë¡œ ê°€ì ¸ì˜¤ì§€ ëª»í•˜ë„ë¡ ë§‰ëŠ” ì¤‘ìš”í•œ ë³´ì•ˆ ê·œì¹™ì…ë‹ˆë‹¤.

ì´ë•Œ 'ì¶œì²˜'ëŠ” **í”„ë¡œí† ì½œ, í˜¸ìŠ¤íŠ¸(ë„ë©”ì¸), í¬íŠ¸ ë²ˆí˜¸**ì˜ ì¡°í•©ìœ¼ë¡œ ê²°ì •ë©ë‹ˆë‹¤.

- **ë‚´ React ì•± (ìš”ì²­ì„ ë³´ë‚´ëŠ” ê³³):** `http://localhost:5173`
- **ì™¸ë¶€ API ì„œë²„ (ìš”ì²­ì„ ë°›ëŠ” ê³³):** `https://api.example.com`

ì´ ë‘˜ì€ ì¶œì²˜ê°€ ë‹¤ë¥´ë¯€ë¡œ, ë¸Œë¼ìš°ì €ëŠ” ê¸°ë³¸ì ìœ¼ë¡œ ë°ì´í„° ìš”ì²­ì„ ì°¨ë‹¨í•©ë‹ˆë‹¤. ì™¸ë¶€ API ì„œë²„ê°€ ì‘ë‹µ í—¤ë”ì— "ì´ ì¶œì²˜(`http://localhost:5173`)ëŠ” ë°ì´í„°ë¥¼ ê°€ì ¸ê°€ë„ ì¢‹ì•„"ë¼ëŠ” í—ˆê°€(`Access-Control-Allow-Origin`)ë¥¼ ëª…ì‹œì ìœ¼ë¡œ ë³´ë‚´ì£¼ì§€ ì•ŠëŠ” í•œ, ë¸Œë¼ìš°ì €ëŠ” ì´ ìš”ì²­ì„ ê±°ë¶€í•˜ê³  CORS ì˜¤ë¥˜ë¥¼ ë°œìƒì‹œí‚¤ëŠ” ê²ƒì´ì£ .

### í•´ê²°ì±…: Vite ê°œë°œ ì„œë²„ë¥¼ 'ëŒ€ë¦¬ì¸'ìœ¼ë¡œ ë§Œë“¤ê¸° (Proxy)

ìš°ë¦¬ê°€ ì™¸ë¶€ API ì„œë²„ì˜ ì„¤ì •ì„ ì§ì ‘ ë°”ê¿€ ìˆ˜ëŠ” ì—†ìœ¼ë¯€ë¡œ, ê°œë°œ í™˜ê²½ì—ì„œëŠ” **í”„ë¡ì‹œ(Proxy)** ë¼ëŠ” ìš°íšŒ ì „ëµì„ ì‚¬ìš©í•©ë‹ˆë‹¤. í”„ë¡ì‹œëŠ” 'ëŒ€ë¦¬ì¸'ì´ë¼ëŠ” ëœ»ìœ¼ë¡œ, Vite ê°œë°œ ì„œë²„ê°€ ìš°ë¦¬ React ì•±ì„ ëŒ€ì‹ í•´ì„œ ì™¸ë¶€ API ì„œë²„ì— ë°ì´í„°ë¥¼ ìš”ì²­í•˜ê³  ë°›ì•„ì˜¤ëŠ” ë°©ì‹ì…ë‹ˆë‹¤.

**í”„ë¡ì‹œê°€ ì—†ì„ ë•Œ (CORS ì˜¤ë¥˜ ë°œìƒ)**

```
[React App on localhost:5173] ---âŒ (CORS Block by Browser) ---> [External API Server]
```

**í”„ë¡ì‹œë¥¼ ì‚¬ìš©í•  ë•Œ (ì„±ê³µ)**

```
[React App] <---> [Vite Dev Server (Proxy)] <---> [External API Server]
```

1.  **React ì•±**ì€ ê°™ì€ ì¶œì²˜ì¸ **Vite ê°œë°œ ì„œë²„**ì— ë°ì´í„°ë¥¼ ìš”ì²­í•©ë‹ˆë‹¤. (CORS ë¬¸ì œ ì—†ìŒ)
2.  **Vite ê°œë°œ ì„œë²„(í”„ë¡ì‹œ)** ëŠ” ìš”ì²­ì„ ë°›ì•„ ìš°ë¦¬ë¥¼ ëŒ€ì‹ í•´ì„œ **ì™¸ë¶€ API ì„œë²„**ì— ì „ë‹¬í•©ë‹ˆë‹¤. (ì„œë²„ ê°„ í†µì‹ ì—ëŠ” CORS ì •ì±…ì´ ì ìš©ë˜ì§€ ì•ŠìŒ)
3.  **Vite ê°œë°œ ì„œë²„**ëŠ” ì™¸ë¶€ ì„œë²„ë¡œë¶€í„° ë°›ì€ ë°ì´í„°ë¥¼ **React ì•±**ì— ì•ˆì „í•˜ê²Œ ì „ë‹¬í•©ë‹ˆë‹¤.

---

### Vite í”„ë¡ì‹œ ì„¤ì • ë°©ë²•

#### 1ë‹¨ê³„: `vite.config.js` íŒŒì¼ ì„¤ì •

í”„ë¡œì íŠ¸ì˜ ë£¨íŠ¸ ë””ë ‰í† ë¦¬ì— ìˆëŠ” `vite.config.js` íŒŒì¼ì„ ì—´ê³ , `server.proxy` ì˜µì…˜ì„ ì¶”ê°€í•©ë‹ˆë‹¤.

```javascript
// vite.config.js
import { defineConfig } from 'vite';
import react from '@vitejs/plugin-react';

export default defineConfig({
  plugins: [react()],
  server: {
    proxy: {
      // '/api'ë¡œ ì‹œì‘í•˜ëŠ” ê²½ë¡œì˜ ìš”ì²­ì€ targetìœ¼ë¡œ ì „ë‹¬í•©ë‹ˆë‹¤.
      '/api': {
        // ì‹¤ì œ API ì„œë²„ ì£¼ì†Œë¥¼ ì…ë ¥í•©ë‹ˆë‹¤.
        target: 'https://learn.codeit.kr',
        // ì¶œì²˜(Origin) í—¤ë”ë¥¼ target ì£¼ì†Œì— ë§ê²Œ ë³€ê²½í•©ë‹ˆë‹¤.
        changeOrigin: true,
        // ìš”ì²­ ê²½ë¡œì—ì„œ '/api'ë¥¼ ì œê±°í•©ë‹ˆë‹¤.
        rewrite: (path) => path.replace(/^\/api/, ''),
      },
    },
  },
});
```

#### 2ë‹¨ê³„: `fetch` ìš”ì²­ ì£¼ì†Œ ìˆ˜ì •

APIë¥¼ í˜¸ì¶œí•˜ëŠ” íŒŒì¼(ì˜ˆ: `src/api.js`)ì—ì„œ `fetch` í•¨ìˆ˜ì˜ ì£¼ì†Œë¥¼ í”„ë¡ì‹œ ê²½ë¡œì— ë§ê²Œ ìˆ˜ì •í•©ë‹ˆë‹¤.

```javascript
// src/api.js

// ìˆ˜ì • ì „
// const response = await fetch('https://learn.codeit.kr/1029/foods');

// ìˆ˜ì • í›„ ğŸ‘‡
export async function getFoods() {
  const response = await fetch('/api/1029/foods');
  // ...
}
```

#### 3ë‹¨ê³„: ê°œë°œ ì„œë²„ ì¬ì‹œì‘

ì„¤ì •ì„ ë§ˆì¹œ í›„ì—ëŠ” ë°˜ë“œì‹œ Vite ê°œë°œ ì„œë²„ë¥¼ ê»ë‹¤ê°€(`Ctrl` + `C`) ë‹¤ì‹œ ì‹¤í–‰(`npm run dev`)í•´ì•¼ í”„ë¡ì‹œ ì„¤ì •ì´ ì ìš©ë©ë‹ˆë‹¤.

ì´ì œ React ì•±ì—ì„œ `/api/1029/foods`ë¡œ ë³´ë‚´ëŠ” ëª¨ë“  ìš”ì²­ì€ Vite ê°œë°œ ì„œë²„ì— ì˜í•´ ì•ˆì „í•˜ê²Œ `https://learn.codeit.kr/1029/foods`ë¡œ ì „ë‹¬ë˜ë¯€ë¡œ, ë” ì´ìƒ CORS ì˜¤ë¥˜ ì—†ì´ ë°ì´í„°ë¥¼ ë°›ì•„ì˜¬ ìˆ˜ ìˆìŠµë‹ˆë‹¤.
