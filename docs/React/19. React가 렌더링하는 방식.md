## React는 화면을 어떻게 그릴까? (렌더링과 가상 DOM)

React 컴포넌트는 **`props`** 와 **`state`** 라는 두 데이터를 사용하여 화면을 그립니다. `props`나 `state`가 변경되면, 컴포넌트는 그에 맞춰 새로운 모습을 화면에 보여주죠.

이번에는 `state`가 변경되었을 때 React가 어떻게 화면을 똑똑하게 업데이트하는지, 그 **렌더링(Rendering) 방식**에 대해 알아보겠습니다.

### 만약 React가 없다면? (DOM 직접 조작)

'주사위 게임' 예시에서 '던지기' 버튼을 누르면, 주사위 이미지, 총점, 기록이 한 번에 바뀝니다. 만약 이 기능을 순수 JavaScript로 구현한다면 다음과 같은 과정을 거쳐야 합니다.

1.  `id`나 `class`로 주사위 이미지(`<img>`) 요소를 찾는다.
2.  해당 요소의 `src` 속성을 새로운 주사위 이미지 경로로 변경한다.
3.  총점(`<h2>`) 요소를 찾아 `textContent`를 새로운 총점 값으로 변경한다.
4.  기록(`<p>`) 요소를 찾아 `textContent`를 새로운 기록 값으로 변경한다.

이처럼 **어떤 부분이 변경되었는지 개발자가 일일이 기억하고, 해당 DOM 요소를 직접 찾아 수정**하는 방식은 매우 번거롭습니다. 프로젝트가 커질수록 실수할 가능성이 커지고, 코드도 복잡해지죠. 🤯

### React의 접근법: 그냥 새로 그린다!

React는 이런 복잡한 문제를 아주 단순한 방식으로 해결합니다. 바로 **"데이터가 바뀌면, 그냥 컴포넌트 전체를 새로 그린다!"** 는 전략을 사용합니다.

'던지기' 버튼을 누르면 `state`가 변경되고, React는 `App` 함수 컴포넌트를 **통째로 다시 호출**합니다. 이때 함수는 변경된 최신 `state` 값을 기반으로 새로운 UI 요소(React Element) 전체를 반환합니다. 개발자는 "어디를 바꿔야 하지?"를 고민할 필요 없이, 그저 **"현재 상태에서는 이 모습이어야 해"** 라고 선언하기만 하면 됩니다.

하지만 이런 방식은 한 가지 의문을 낳습니다.

> "매번 모든 걸 새로 그리면, 아무 변화가 없는 '던지기' 버튼 같은 요소까지 전부 다시 그리니까 비효율적이지 않나요?"

맞습니다. 만약 이 모든 과정을 실제 브라우저 화면(DOM)에 직접 적용한다면 성능이 크게 저하될 것입니다. 그래서 React는 이 문제를 해결하기 위해 **가상 DOM(Virtual DOM)** 이라는 아주 영리한 기술을 사용합니다.

### 가상 DOM (Virtual DOM)의 역할

**가상 DOM**은 실제 브라우저의 DOM 구조를 본떠 JavaScript 객체 형태로 메모리에 저장해 둔 **가상의 DOM 트리**입니다. React는 다음과 같은 과정을 통해 화면을 효율적으로 업데이트합니다.

1.  **State 변경 및 리렌더링**: `state`가 변경되면, React는 컴포넌트 함수를 다시 호출하여 **새로운 가상 DOM 트리**를 만듭니다.

2.  **비교 (Diffing)**: React는 이전에 만들었던 **기존 가상 DOM 트리**와 방금 새로 만든 **가상 DOM 트리를 비교**합니다. 이 과정을 **'비교 알고리즘(Diffing Algorithm)'** 이라고 부릅니다.

3.  **실제 DOM 업데이트 (Reconciliation)**: 두 가상 DOM을 비교하여 **정확히 바뀐 부분만 찾아냅니다.** 그리고 그 변경 사항만 실제 브라우저의 DOM에 **최소한으로 적용**합니다. 이 과정을 **'재조정(Reconciliation)'** 이라고 합니다.

결과적으로, '던지기' 버튼처럼 변화가 없는 부분은 건드리지 않고, 정확히 변경이 필요한 주사위 이미지와 텍스트 부분만 효율적으로 업데이트하는 것이죠.

### 가상 DOM을 사용하면 좋은 점

1.  **개발 편의성 향상**: 개발자는 더 이상 복잡한 DOM 조작에 신경 쓸 필요가 없습니다. 오직 **데이터(`state`)를 어떻게 관리하고, 그 데이터에 따라 어떤 UI를 보여줄지만 고민**하면 됩니다. 코드가 훨씬 단순하고 선언적으로 바뀝니다.

2.  **성능 최적화**: React는 변경 사항들을 모아서 한 번에 처리(Batch Update)하는 등 내부적으로 최적화 로직을 수행합니다. 가상 DOM을 통해 실제 DOM에 대한 접근을 최소화하므로, 복잡한 UI에서도 뛰어난 성능을 유지할 수 있습니다.

이처럼 React는 **"전체를 새로 그린다"** 는 단순한 개발 경험을 제공하면서도, **가상 DOM**을 통해 **"바뀐 부분만 효율적으로 업데이트"** 하는 똑똑한 내부 동작으로 뛰어난 성능을 보장합니다.
